@model KGID_Models.KGID_User.tbl_new_employee
@using KGID_Models.KGID_User
@{
    ViewBag.Title = "NewEmployeeSearch";
}
@*@using (Html.BeginForm("NewEmployeeSearch", "GetNewEmpMobileNo", FormMethod.Post, new { id = "submitForm" }))
    {
        @Html.AntiForgeryToken();*@

<div class="row">
    <div class="col-lg-12">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">KGID New Proposal</h6>
            </div>
            @*@if (Model != null)
                {*@
            <div class="card-body">
                <div class="row">
                    <div class="form-group col-md-3">
                        <label for="postedFile"></label>                       
                        <label>
                            <input type="radio" class="radio" name="SerachByDepartment" id="SearchByDepartmentrbtn" value="option1" required="required" checked>
                            Search By Department
                        </label>
                    </div>

                    <div class="form-group col-md-3 dept_serch">
                        <label>
                            DDO Code
                        </label>

                        @Html.DropDownList("DDOMaster", new SelectList(ViewBag.data, "dm_ddo_code", "dm_ddo_code"), "Select a DDO Code", new { @class = "form-control", @id = "dept_id" })
                        @*@Html.DropDownListFor(model =>Model.em_dept_code, new List<SelectListItem>(), "Select Department...",
                            new { @class = "form-control", @id = "dept_id" })*@
                        @*<span class="font-italic">@Model.em_dept_code</span>*@
                        @*<input name="DeptName" type="text" class="form-control" id="dept_name" placeholder="" width="10">*@
                    </div>

                    <div class="form-group col-md-3 dept_serch">
                        @*<label>
                                Name
                            </label>*@
                        <label>
                            Name
                        </label>
                        @Html.DropDownList("DeptMaster", new SelectList(Enumerable.Empty<SelectListItem>(), "dm_deptcode", "dm_deptname_english"),
        "Select a Name", new { @class = "form-control",id = "deptNameList" })

                        @*@Html.DropDownListFor(model =>Model.em_employeename, new List<SelectListItem>(), "Select Name...",
                            new { @class = "form-control", @id = "emp_id" })*@
                        @*<span class="font-italic">@Model.em_employeename</span>
                            <input name="Name" type="text" class="form-control" id="name" placeholder="">*@
                    </div>

                    @*<div class="form-group col-md-3">
                            <label>
                                DOB
                            </label>
                            <span class="font-italic">@Model.em_date_of_birth</span>
                            <input name="DOB" type="text" class="form-control" id="DOB" placeholder="">
                        </div>*@
                </div>

                <div class="row dept_serch">
                    <div class="form-group col-md-3">
                        <label>

                        </label>
                    </div>
                    <div class="form-group col-md-3">
                        <label>
                            Mobile Number
                        </label>
                        <span class="font-italic">@Model.em_mobilenumber</span>
                        <input name="Mobile" type="text" class="bg-gray-400" id="mobile_no" placeholder="" width="80" disabled>
                    </div>
                    <div class="form-group col-md-3">
                        <label>
                            Email
                        </label>
                        <span class="font-italic">@Model.em_email</span>
                        <input name="Email" type="text" class="bg-gray-400" id="email" placeholder="" width="80" disabled>
                    </div>
                </div>

                <div class="row">
                    <br />
                </div>

                <div class="row">
                    <div class="form-group col-md-3">
                        <label for="postedFile"></label>
                        <label>
                            <input type="radio" name="SerachByDepartment" id="SearchbyMobNorbtn" value="option2" required="required">
                            Search By Mobile No or Email
                        </label>
                    </div>
                    <div class="form-group col-md-3 dept_serch_mob">
                        <label>
                            Mobile Number
                        </label>
                        <span class="font-italic">@Model.em_mobilenumber</span>
                        <input name="Mobile" type="text" class="form-control" id="mobile_no1" placeholder="" width="10">
                    </div>
                    <div class="form-group col-md-3 dept_serch_mob">
                        <label>
                            Email
                        </label>
                        <span class="font-italic">@Model.em_email</span>
                        <input name="Mobile" type="text" class="form-control" id="email1" placeholder="" width="10">
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-sm-6">
                        <label for="txtOTP">OTP</label>
                        <input type="text" id="txtOTP" class="form-control" placeholder="Enter OTP">
                    </div>
                    <div class="form-group col-sm-6">
                        <label for="txtOTP"></label><br />
                        <input type="button" id="btnAuth" class="btn btn-primary" value="Authenticate">
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-md-12">
                    </div>
                    <div class="form-group col-md-2">
                        <button type="submit" class="btn btn-google" onclick="searchEmpDetails();">Search</button>
                    </div>
                </div>

                @*<div class="row">
                        <table id="tblNewEmployeeList" class="table table-striped table-bordered col-md-12" width="100" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>SL. NO.</th>
                                    <th>Employee Name</th>
                                    <th>
                                        Date Of Birth
                                    </th>
                                    <th>
                                        Mobile Number
                                    </th>
                                    <th>
                                        Email
                                    </th>
                                    <th>
                                        Father Name
                                    </th>
                                    <th>
                                        Gender
                                    </th>
                                    <th>
                                        Job Type
                                    </th>
                                    <th>
                                        Place of Posting
                                    </th>
                                    <th>
                                        Department Code
                                    </th>
                                    <th>
                                        Designation ID
                                    </th>
                                </tr>
                            </thead>
                            @{
                                int slno = 0;
                            }
                            @if (Model != null)
                            {
                                foreach (tbl_new_employee item in Model.GetNewEmployeeList)
                                {
                                    <tr>
                                        <td>@{ slno++; }@slno</td>
                                        <td>@item.em_employeename</td>
                                        <td>@item.em_date_of_birth</td>
                                        <td>@item.em_mobilenumber</td>
                                        <td>@item.em_email</td>
                                        <td>@item.em_father_name</td>
                                        <td>@item.em_gender</td>
                                        <td>@item.em_job_type</td>
                                        <td>@item.em_place_of_posting</td>
                                        <td>@item.em_dept_code</td>
                                        <td>@item.em_designation_id</td>
                                    </tr>
                                }
                            }
                        </table>
                    </div>*@

                <div class="row">
                    <table id="tblNewEmployeeList1" class="table table-striped table-bordered col-md-12" width="100" cellspacing="0">
                        <thead>
                            <tr>
                                <th>SL. NO.</th>
                                <th>Employee Name</th>
                                <th>
                                    Date Of Birth
                                </th>
                                <th>
                                    Mobile Number
                                </th>
                                <th>
                                    Email
                                </th>
                                <th>
                                    Father Name
                                </th>
                                <th>
                                    Gender
                                </th>
                                <th>
                                    Job Type
                                </th>
                                <th>
                                    Place of Posting
                                </th>
                                <th>
                                    Department Code
                                </th>
                                <th>
                                    Designation ID
                                </th>
                            </tr>
                        </thead>
                        @*@{
                                int slno = 0;
                            }
                            @if (Model != null)
                            {
                                foreach (tbl_new_employee item in Model.GetNewEmployeeList)
                                {
                                    <tr>
                                        <td>@{ slno++; }@slno</td>
                                        <td>@item.em_employeename</td>
                                        <td>@item.em_date_of_birth</td>
                                        <td>@item.em_mobilenumber</td>
                                        <td>@item.em_email</td>
                                        <td>@item.em_father_name</td>
                                        <td>@item.em_gender</td>
                                        <td>@item.em_job_type</td>
                                        <td>@item.em_place_of_posting</td>
                                        <td>@item.em_dept_code</td>
                                        <td>@item.em_designation_id</td>
                                    </tr>
                                }
                            }*@
                    </table>
                </div>
            </div>
            @*}
                else
                {
                    Response.Redirect("~/Employee/NewEmployeeSearch");
                }*@
            <div class="row">
                <div class="form-group col-sm-6 text-right">
                    <input type="button" id="btnSubmit" class="btn btn-primary" value="Submit">
                </div>
            </div>
            <div class="card-footer">
            </div>
        </div>
    </div>
</div>
@*}*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>*@
<script type="text/javascript">
    $(document).ready(function () {
        $("#tblNewEmployeeList").DataTable({
            "pageLength": 50
        });

        $("#dept_id").change(function () {
            var deptCode = $(this).val();
            $.getJSON("../employee/LoadEmployeeNamesByDDO", { _deptCode: deptCode },
                function (data) {
                    var select = $("#deptNameList");
                    select.empty();
                    select.append($('<option/>', {
                        value: 0,
                        text: "Select a Name"
                    }));
                    $.each(data, function (index, itemData) {
                        select.append($('<option/>', {
                            value: itemData.em_dept_code,
                            text: itemData.em_employeename
                        }));
                    });
                });
        });


        $("#deptNameList").change(function () {
            var deptCode = $(this).val();
            $.getJSON("../employee/LoadMobileAndEmailByDeptCode", { _deptCode: deptCode },
                function (result) {
                    if (result.em_mobilenumber) {
                        $('#mobile_no').val(result.em_mobilenumber);
                    }
                    if (result.em_email) {
                        $('#email').val(result.em_email);
                    }
                });
        });
        $(".dept_serch_mob").hide();       
        if ($('input[name="SerachByDepartment"]:checked').length == 0) {
            //alert("please select a radio button");
        }

        $("#SearchbyMobNorbtn").click(function () {
            $(".dept_serch_mob").show();   
            $(".dept_serch").hide();
        });

        $("#SearchByDepartmentrbtn").click(function () {
            $(".dept_serch_mob").hide();
            $(".dept_serch").show();
        });

        //else
        //{
        //    $("#mobile_no1").hide();
        //    $("#email1").hide();
        //}

    });

    function searchEmpDetails() {
        if ($('input[name="SerachByDepartment"]:checked').length == 0) {
            //alert("please select a radio button");
        }
        else {
            var radioValue = $("input[name='SerachByDepartment']:checked").val();
            if (radioValue) {
                //alert("Your are a - " + radioValue);
            }
            //$.fn.dataTable.moment('M/D/YYYY');          
            $('#tblNewEmployeeList1').DataTable({
                "ajax": {
                    "LengthMenu": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
                    "url": "../employee/getEmployeeData/",
                    "type": "GET",
                    "datatype": "json",
                    "dataSrc": "",
                    "autoWidth": false,
                    //"processing": true,
                    //"serverSide": true
                },
                //"fields": [{
                //    "label": "em_date_of_birth",
                //    "name": "em_date_of_birth",
                //    "def": function () { return new Date(); },
                //    "type": "datetime",
                //    "format": 'DD/MM/YYYY HH:mm'
                //}
                //],  
                //"columnDefs": [
                //    { "type": 'date-dd-mmm-yyyy', "targets": 2,},                 
                //],
                "columnDefs": [
                    { "width": "10px", "targets": 0 },
                    { "width": "40px", "targets": 1 },
                    { "width": "100px", "targets": 2 },
                    { "width": "70px", "targets": 3 },
                    { "width": "70px", "targets": 4 },
                    { "width": "70px", "targets": 5 },
                    { "width": "10px", "targets": 6 },
                    { "width": "40px", "targets": 7 },
                    { "width": "50px", "targets": 8 },
                    { "width": "70px", "targets": 9 },
                    { "width": "70px", "targets": 10 }
                   
                ],
                "columns": [
                    { "data": "em_employee_id", "name": "em_employee_id"},
                    { "data": "em_employeename", "name": "em_employeename"},
                    { "data": "em_date_of_birth", "name": "em_date_of_birth"},                  
                    { "data": "em_mobilenumber", "name": "em_mobilenumber" },
                    { "data": "em_email", "name": "em_email"},
                    { "data": "em_father_name", "name": "em_farher_name"},
                    { "data": "em_gender", "name": "em_gender"},
                    { "data": "em_job_type", "name": "em_job_type"},
                    { "data": "em_place_of_posting", "name": "em_place_of_posting"},
                    { "data": "em_dept_code", "name": "em_dept_code"},
                    { "data": "em_designation_id", "name": "em_designation_id"}
                ]
            });

            //table.ajax.reload(null, false);
        }
    }

</script>



